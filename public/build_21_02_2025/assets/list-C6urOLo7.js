import{r as a,p as H,o as K,B as O,ab as X,a as c,c as n,b as t,d as p,w as x,e as h,G as T,C as S,X as N,H as z,f as y,E as U,F as $,h as J,K as r,I as Q,x as F,t as L}from"./app-Bv7sA21o.js";import{_ as W}from"./tooltip-BrvWqPPW.js";import{d as B}from"./modal-WLjbOo64.js";import{a as C}from"./common-iZsm-le3.js";import"./dayjs.min-CU4dOPv8.js";const Y={class:"page-wrap property-add"},Z={class:"page-title mb-4"},j={class:"row gy-3 align-items-center justify-content-end"},tt={class:"col-12"},et={class:"row gy-3"},st=t("div",{class:"col align-self-end"},[t("h1",{class:"h2 mb-0"},"Coupon List")],-1),ot={class:"col-auto"},lt=t("i",{class:"bi bi-plus-lg fs-6 lh-1 me-2"},null,-1),at={class:"col-12 col-lg-7"},ct={class:"search-filter"},nt={class:"row gy-3 gx-2"},dt={class:"col-12 col-md-4 col-lg-3 col-xxl"},it={class:"form-group mb-0"},ut={class:"col-12 col-md-4 col-lg-3 col-xxl"},rt={class:"form-group mb-0"},_t=t("option",{value:"",selected:"",disabled:""},"Status",-1),ht=t("option",{value:"1"},"Active",-1),pt=t("option",{value:"0"},"Inactive",-1),mt={class:"col-12 col-md-auto"},vt={class:"btn-group gap-2"},ft=["disabled"],bt=t("span",{class:"icon-search"},null,-1),gt=[bt],yt=["onClick"],wt=t("span",{class:"bi bi-arrow-clockwise"},null,-1),kt=[wt],xt={class:"section"},Ct={key:0,class:"d-flex justify-content-center py-5"},Vt=t("div",{class:"spinner-border",role:"status"},null,-1),At=[Vt],Tt={key:0,class:"outer-wrapper"},St={class:"table-wrap"},Ft={class:"table-responsive"},Lt={class:"table align-middle mb-0 mw-lg"},Nt={width:"45px"},Ut=t("th",{width:"20%",class:"text-secondary fw-semibold"},"Title",-1),$t=t("th",{width:"15%",class:"text-secondary fw-semibold"},"Coupon Code",-1),Bt=t("th",{class:"text-secondary fw-semibold"},"Discount",-1),Dt=t("th",{class:"text-secondary fw-semibold"},"Validity",-1),It=t("th",{class:"text-secondary fw-semibold"},"Stay dates between",-1),Et=t("th",{width:"7%",class:"text-secondary fw-semibold"},"Status",-1),Mt=t("th",{style:{width:"90px"},class:"text-secondary fw-semibold"},"Action",-1),Rt=["checked","value"],Pt={class:"position-relative"},qt={class:"btn-group d-flex align-items-center gap-3"},Gt={type:"button",class:"btn-none text-primary fw-semibold text-start","data-bs-toggle":"tooltip"},Ht={key:0,class:"spinner-border spinner-border-sm",role:"status"},Kt=["onClick"],Ot=t("i",{class:"bi bi-download fs-6"},null,-1),Xt=[Ot],zt={class:"form-check form-switch"},Jt=["checked","onChange"],Qt={class:"action-btn-group mb-0 mw-0"},Wt=t("i",{class:"bi bi-pencil-square"},null,-1),Yt=["onClick"],Zt=t("i",{class:"icon-bi bi-trash"},null,-1),jt=[Zt],te={class:"table-footer pt-3"},ee={class:"row align-items-center"},se={class:"col-auto"},oe=["disabled"],le={key:1,class:"message text-center"},ae=t("h6",{class:"fw-bold"},"No Record Found",-1),ce=[ae],he={__name:"list",setup(ne){a([]);const m=a([]),w=a(!1),_=a(!1),d=a([]),v=a(),k=a(!1),f=a(),D=a(),I=a(),b=a(),E=o=>{f.value="",D.value="",I.value="",b.value="",o(),F(()=>{g()})},V=o=>(console.log(o,"value"),o.split(",")),g=o=>{k.value=!0,y.get("/api/get/coupon/code/list",{params:{title:f.value,status:b.value}}).then(e=>{e.data.status&&(m.value=e.data.data,setTimeout(()=>{_.value=!1,w.value=!1,d.value=[],k.value=!1},400))}).catch(e=>{k.value=!1})},M=()=>{_.value?(w.value=!0,d.value=[],v.value.forEach(o=>{d.value.push(o.value)})):(w.value=!1,d.value=[])};H(d,(o,e)=>{var l;o.length!=((l=v==null?void 0:v.value)==null?void 0:l.length)?_.value=!1:o.length&&(_.value=!0)});const R=o=>{B("Are you sure you want to delete?",e).show();function e(){y.delete(`/api/coupon/code/delete/${o}`).then(l=>{l.data.status&&(L(l.data.message,"success").show(),F(()=>{g()}))}).catch(l=>{console.log(l)})}},P=()=>{B("Are you sure you want to delete?",o).show();function o(){y.post("/api/coupon/code/delete/multiple",{ids:d.value}).then(e=>{e.data.status&&(L(e.data.message,"success").show(),F(()=>{g()}))}).catch(e=>{console.log(e)})}},q=(o,{target:e})=>{y.post(`/api/coupon/code/update/status/${o}`,{status:Number(e.checked)}).then(l=>{l.data.status&&L(l.data.message,"success").show()}).catch(l=>{console.log(l)})},G=(o,e)=>{m.value[e].coupon_download_loader=!0,y.post("/api/couponcode/export",{id:o},{responseType:"blob"}).then(l=>{const A=new Blob([l.data],{type:"application/octet-stream"}),s=window.URL.createObjectURL(A),i=document.createElement("a");i.href=s,i.setAttribute("download","coupon-codes.xlsx"),document.body.appendChild(i),i.click(),document.body.removeChild(i),setTimeout(()=>{m.value[e].coupon_download_loader=!1},400)}).catch(l=>{console.log(l)})};return K(()=>{g()}),(o,e)=>{const l=O("router-link"),A=X("clipboard");return c(),n("div",Y,[t("div",Z,[t("div",j,[t("div",tt,[t("div",et,[st,t("div",ot,[p(l,{to:{name:"add-coupon"},class:"btn rounded-pill btn-secondary-light"},{default:x(()=>[lt,U(" Add Coupon ")]),_:1})])])]),t("div",at,[t("div",ct,[p(h(J),{as:"div"},{default:x(({errors:s,resetForm:i})=>[t("div",nt,[t("div",dt,[t("div",it,[p(h($),{name:"coupon_title",type:"text",class:"form-control",placeholder:"Title",rules:"numeric",modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=u=>f.value=u)},null,8,["modelValue"])])]),t("div",ut,[t("div",rt,[p(h($),{name:"booking_status",as:"select",class:"form-control",modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=u=>b.value=u)},{default:x(()=>[_t,ht,pt]),_:1},8,["modelValue"])])]),t("div",mt,[t("div",vt,[t("button",{onClick:g,class:"btn btn-primary btn-icon",disabled:!f.value&&!b.value},gt,8,ft),t("button",{onClick:u=>E(i),class:"btn btn-icon btn-clear btn-warning"},kt,8,yt)])])])]),_:1})])])])]),t("section",xt,[k.value?(c(),n("div",Ct,At)):(c(),n(T,{key:1},[m.value.length?(c(),n("div",Tt,[t("div",St,[t("div",Ft,[t("table",Lt,[t("thead",null,[t("tr",null,[t("th",Nt,[S(t("input",{class:"form-check-input form-check-lg mt-0",type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=s=>_.value=s),onChange:M},null,544),[[N,_.value]])]),Ut,$t,Bt,Dt,It,Et,Mt])]),t("tbody",null,[(c(!0),n(T,null,z(m.value,(s,i)=>(c(),n("tr",{key:i},[t("td",null,[S(t("input",{class:"form-check-input form-check-lg mt-0",ref_for:!0,ref_key:"selectCheckRef",ref:v,checked:w.value,value:s.id,"onUpdate:modelValue":e[3]||(e[3]=u=>d.value=u),type:"checkbox"},null,8,Rt),[[N,d.value]])]),t("td",null,r(s.title),1),t("td",null,[t("div",Pt,[t("div",qt,[S((c(),n("button",Gt,[U(r(V(s.codes)[0]),1)])),[[A,V(s.codes)[0]]]),V(s.codes).length>1?(c(),n(T,{key:0},[s.coupon_download_loader?(c(),n("div",Ht)):(c(),n("button",{key:1,type:"button",class:"btn-none text-dark fw-semibold text-start",onClick:u=>G(s.id,i)},Xt,8,Kt))],64)):Q("",!0)]),p(W,{"custom-class":"info-tooltip","custom-hover-message":"Copy","custom-message":"Copied!","custom-trigger":"hover manual","custom-hide-time":"600"})])]),t("td",null,r(s.discount)+r(s.discount_type=="flat"?"":"%"),1),t("td",null,r(h(C)(s.start_date))+" to "+r(h(C)(s.end_date)),1),t("td",null,r(h(C)(s.stay_date_from))+" to "+r(h(C)(s.stay_date_to)),1),t("td",null,[t("div",zt,[t("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"s1",checked:s.status==1,onChange:u=>q(s.id,u),"true-value":"1","false-value":"0"},null,40,Jt)])]),t("td",null,[t("ul",Qt,[t("li",null,[p(l,{to:{name:"add-coupon",params:{id:s.id}},class:"btn ps-0 p-1 fs-5 text-black"},{default:x(()=>[Wt]),_:2},1032,["to"])]),t("li",null,[t("button",{onClick:u=>R(s.id),class:"btn p-1 fs-5 text-black"},jt,8,Yt)])])])]))),128))])])])]),t("div",te,[t("div",ee,[t("div",se,[t("button",{class:"btn btn-save btn-primary",onClick:P,disabled:!_.value&&d.value.length==0||d.value.length==0}," Delete Selected ",8,oe)])])])])):(c(),n("div",le,ce))],64))])])}}};export{he as default};
