import{j as H,i as K,r as n,p as $,o as q,B as z,a as r,c as i,b as e,d as u,w as p,e as _,G as R,H as L,f as N,F as g,K as d,L as J,E as Q,h as W,a1 as X,a2 as Z,x as j}from"./app-Bv7sA21o.js";import{d as ee}from"./common-iZsm-le3.js";import{d as y}from"./dayjs.min-CU4dOPv8.js";const a=k=>(X("data-v-472835c6"),k=k(),Z(),k),te={class:"page-wrap property-add"},ae={class:"page-title mb-4"},oe={class:"row gy-3"},le=a(()=>e("div",{class:"col align-self-end"},[e("h1",{class:"h2 mb-0"},"Sale Report")],-1)),se={class:"col-12"},ne={class:"search-filter"},ce={class:"row gy-3 gx-2"},de={class:"col-12 col-md-4 col-lg"},re={class:"form-group mb-0"},ie=a(()=>e("option",{value:"",selected:"",disabled:""},"Property Name",-1)),ue=["value"],_e={class:"col-12 col-md-4 col-lg-3 col-xl-2 col-xxl"},pe={class:"form-group mb-0"},me=a(()=>e("option",{value:"",selected:"",disabled:""},"Type",-1)),ve=a(()=>e("option",{value:"checkin"},"Check In",-1)),he=a(()=>e("option",{value:"BookingDate"},"Booking Date",-1)),fe={class:"col-12 col-md-4 col-lg"},be={class:"form-group mb-0"},ge={class:"col-12 col-md-4 col-lg"},ye={class:"form-group mb-0"},ke=a(()=>e("option",{value:"",selected:"",disabled:""},"Channel",-1)),xe=a(()=>e("option",{value:"Agoda"},"Agoda",-1)),De=a(()=>e("option",{value:"Airbnb"},"Airbnb",-1)),Ve=a(()=>e("option",{value:"Booking.com"},"Booking.com",-1)),Ce=a(()=>e("option",{value:"MakeMyTrip"},"MakeMyTrip",-1)),we=a(()=>e("option",{value:"PMS"},"PMS",-1)),Me={class:"col-12 col-md-4 col-lg"},Pe={class:"form-group mb-0"},Se=a(()=>e("option",{value:"",selected:"",disabled:""},"Payment Status",-1)),Ye=a(()=>e("option",{value:"Confirmed"},"Confirmed",-1)),Re=a(()=>e("option",{value:"Canceled"},"Canceled",-1)),Ie={class:"col-12 col-md-auto"},Be={class:"btn-group gap-2"},Te=["disabled"],Ae=a(()=>e("span",{class:"icon-search"},null,-1)),Fe=[Ae],Le=["onClick"],Ne=a(()=>e("span",{class:"bi bi-arrow-clockwise"},null,-1)),Ue=[Ne],Ee=a(()=>e("i",{class:"bi bi-file-earmark-excel me-2 fs-6"},null,-1)),Oe={class:"section"},Ge={key:0,class:"d-flex justify-content-center py-5"},He=a(()=>e("div",{class:"spinner-border",role:"status"},null,-1)),Ke=[He],$e={key:0,class:"outer-wrapper"},qe={class:"table-wrap"},ze={class:"table-responsive"},Je={class:"table table-list-2 align-middle mb-0 mw-lg"},Qe=a(()=>e("thead",null,[e("tr",null,[e("th",null,"Booking ID"),e("th",null,"Property Name"),e("th",null,"Location"),e("th",null,"Guest Name"),e("th",null,"Channel"),e("th",null,"Price"),e("th",null,"Paid"),e("th",null,"Tax"),e("th",null,"Tax Amount")])],-1)),We={key:1,class:"message text-center"},Xe=a(()=>e("h6",{class:"fw-bold"},"No Record Found",-1)),Ze=[Xe],je={__name:"sale-report",setup(k){var A,F;const I=K("store"),V=(A=I.getters.user)==null?void 0:A.role,C=(F=I.getters.user)==null?void 0:F.id,m=n(!1),x=n([]),w=n(""),M=n(""),U=n(),D=n("");n(0);const B=n([]),v=n(""),T=n(),E=n(""),h=n(""),f=n(""),s=n();$(w,(c,t)=>{c&&(E.value=y(c).add(1,"day").format(),w.value>=M.value&&T.value.clearValue(),(w.value>=M.value||!M.value)&&T.value.openMenu())});const P=c=>{if(m.value=!0,U.value&&s.value==null)return classDanger.value=!0,m.value=!1,!1;N.post("/api/sale/report/"+V+"/"+C,{checkin_date:s.value?y(s.value[0]).format("YYYY-MM-DD"):"",checkout_date:s.value?y(s.value[1]).format("YYYY-MM-DD"):"",searchPropertyId:v.value,searchChannel:h.value,searchPaymentStatus:f.value,searchtype:D.value,role:V.value,userId:C.value}).then(t=>{t.data.status&&(B.value=t.data.propertyList,x.value=t.data.data,dataRow.value=t.data.data,x.value.forEach((b,o)=>{checkBookingPaymentStatus(o,b)}),setTimeout(()=>{vCheckAll.value=!1,checkedSelectAll.value=!1,vSelectCheckValue.value=[],m.value=!1},400))}).catch(t=>{m.value=!1})},O=()=>{N.post("/api/get/booking/sale/report/export",{checkin_date:s.value?y(s.value[0]).format("YYYY-MM-DD"):"",checkout_date:s.value?y(s.value[1]).format("YYYY-MM-DD"):"",searchPropertyId:v.value,searchChannel:h.value,searchtype:D.value,searchPaymentStatus:f.value,role:V.value,userId:C.value},{responseType:"blob"}).then(c=>{const t=new Blob([c.data],{type:"application/octet-stream"}),b=window.URL.createObjectURL(t),o=document.createElement("a");o.href=b,o.setAttribute("download","sale-report.xlsx"),document.body.appendChild(o),o.click(),document.body.removeChild(o)}).catch(c=>{})},G=c=>{c(),j(()=>{P()})};return q(()=>{P()}),(c,t)=>{const b=z("DatePicker");return r(),i("div",te,[e("div",ae,[e("div",oe,[le,e("div",se,[e("div",ne,[u(_(W),{as:"div"},{default:p(({errors:o,resetForm:S})=>[e("div",ce,[e("div",de,[e("div",re,[u(_(g),{name:"property_name",as:"select",class:"form-control",modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=l=>v.value=l)},{default:p(()=>[ie,(r(!0),i(R,null,L(B.value,(l,Y)=>(r(),i("option",{key:Y,value:l.id},d(l.home_name),9,ue))),128))]),_:1},8,["modelValue"])])]),e("div",_e,[e("div",pe,[u(_(g),{name:"searchtype",as:"select",class:"form-control",modelValue:D.value,"onUpdate:modelValue":t[1]||(t[1]=l=>D.value=l)},{default:p(()=>[me,ve,he]),_:1},8,["modelValue"])])]),e("div",fe,[e("div",be,[u(_(g),{name:"searchDateRange",modelValue:s.value,"onUpdate:modelValue":t[3]||(t[3]=l=>s.value=l)},{default:p(({field:l})=>[u(b,J({ref:"searchDateRangeRef"},l,{modelValue:s.value,"onUpdate:modelValue":t[2]||(t[2]=Y=>s.value=Y),"enable-time-picker":!1,placeholder:"From-To",format:_(ee),"auto-apply":"",range:"","multi-calendars":"","input-class-name":c.classDanger?"form-control border-danger":"form-control"}),null,16,["modelValue","format","input-class-name"])]),_:1},8,["modelValue"])])]),e("div",ge,[e("div",ye,[u(_(g),{name:"channel",as:"select",class:"form-control",modelValue:h.value,"onUpdate:modelValue":t[4]||(t[4]=l=>h.value=l)},{default:p(()=>[ke,xe,De,Ve,Ce,we]),_:1},8,["modelValue"])])]),e("div",Me,[e("div",Pe,[u(_(g),{name:"payment_status",as:"select",class:"form-control",modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=l=>f.value=l)},{default:p(()=>[Se,Ye,Re]),_:1},8,["modelValue"])])]),e("div",Ie,[e("div",Be,[e("button",{onClick:P,class:"btn btn-primary btn-icon",disabled:!v.value&&!s.value&&!h.value&&!f.value},Fe,8,Te),e("button",{onClick:l=>G(S),class:"btn btn-icon btn-clear btn-warning"},Ue,8,Le),e("button",{onClick:O,class:"btn btn-export btn-secondary"},[Ee,Q("Export")])])])])]),_:1})])])])]),e("section",Oe,[m.value?(r(),i("div",Ge,Ke)):(r(),i(R,{key:1},[x.value.length?(r(),i("div",$e,[e("div",qe,[e("div",ze,[e("table",Je,[Qe,(r(!0),i(R,null,L(x.value,(o,S)=>(r(),i("tbody",{key:S},[e("tr",null,[e("td",null,d(o.booking_id),1),e("td",null,d(o.home_name),1),e("td",null,d(o.location),1),e("td",null,d(o.guest_name),1),e("td",null,d(o.channel),1),e("td",null,d(o.payable_amount),1),e("td",null,d(o.payment_received),1),e("td",null,d(o.tax),1),e("td",null,d(o.taxable_amount),1)])]))),128))])])])])):(r(),i("div",We,Ze))],64))])])}}},ot=H(je,[["__scopeId","data-v-472835c6"]]);export{ot as default};
