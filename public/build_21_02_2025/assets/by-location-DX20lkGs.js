import{j as Oe,i as Ee,z as qe,u as $e,r as s,p as ne,A as ue,o as He,B as ye,a as o,c as n,b as e,K as r,e as d,d as _,w as y,I as k,G as x,J as Ke,f as Q,t as ke,E as b,H as Y,F as h,g as A,L as xe,h as Ve,a0 as ze,M as Je,C as We,N as Qe,a1 as Xe,a2 as Ze}from"./app-Bv7sA21o.js";import{d as F}from"./dayjs.min-CU4dOPv8.js";import{f as we,c as B,b as ie}from"./common-iZsm-le3.js";const u=$=>(Xe("data-v-8f7e69b1"),$=$(),Ze(),$),je={class:"page-wrap property-add"},et={class:"page-title mb-4"},tt={class:"row gy-3 align-items-center"},at={class:"col align-self-end"},st={class:"h2 mb-0"},lt={class:"col-auto"},ot=u(()=>e("i",{class:"icon-list me-2"},null,-1)),nt={class:"list-tab list-group mb-4"},ut={class:"list-group-item"},it={key:0,class:"list-group-item"},dt={class:"section"},ct={class:"page-content"},rt={class:"booking-filter"},_t={class:"row gy-4"},vt={class:"col-12"},mt={class:"links-box"},ht={class:"row g-2 g-md-3"},pt={class:"col-6 col-md-4 col-lg-3 col-xxl-auto"},gt={class:"label-radio"},ft=["for"],bt={class:"col-12"},yt={class:"search-location-properties"},kt={class:"row gy-3 gx-2 gx-md-3"},xt={class:"col-6 col-lg-3"},Vt={class:"form-group mb-0"},wt=u(()=>e("label",{for:""},[b("Check-In Date"),e("span",{class:"text-danger"},"*")],-1)),Dt={class:"col-6 col-lg-3"},At={class:"form-group mb-0"},Ct=u(()=>e("label",{for:""},[b("Check-Out Date"),e("span",{class:"text-danger"},"*")],-1)),It={class:"col-12 col-lg-6"},Rt={class:"row gx-2 gy-3 g-md-3"},Nt={class:"col-6 col-lg"},Mt={class:"form-group mb-0"},Pt=u(()=>e("label",{for:""},"No. of Adults",-1)),Tt=u(()=>e("option",{value:"",selected:""},"Please Select",-1)),St=u(()=>e("option",{value:""},"0",-1)),Lt=["value"],Ut={class:"col-6 col-lg"},Yt={class:"form-group mb-0"},Ft=u(()=>e("label",{for:""},"No. of Children",-1)),Bt=u(()=>e("option",{value:"",selected:""},"Please Select",-1)),Gt=u(()=>e("option",{value:""},"0",-1)),Ot=["value"],Et={class:"col-6 col-lg align-self-center"},qt={class:"form-group mb-0"},$t=u(()=>e("label",{for:"",class:"opacity-0 invisible"},"Tax Inclusive",-1)),Ht={class:"form-check form-check-lg form-check-box border-0 p-0"},Kt={class:"row gx-2"},zt={class:"col-auto"},Jt=u(()=>e("div",{class:"col"},[e("label",{for:"cbk-inclusive-tax"},"Tax Inclusive")],-1)),Wt={class:"col-12 col-lg-auto align-self-end"},Qt={type:"submit",class:"btn w-100 btn-primary fw-bold miw-120"},Xt={key:0,class:"spinner-border spinner-border-sm",role:"status"},Zt={key:1},jt={key:0,class:"booking-search-results mt-4 pt-4 border-top border-secondary-2"},ea={key:0,class:"d-flex justify-content-center py-4"},ta=u(()=>e("div",{class:"spinner-border",role:"status"},null,-1)),aa=[ta],sa={class:"row gy-4"},la={class:"col-12"},oa={class:"links-box"},na={class:"row g-2 g-md-3"},ua={class:"label-radio home-radio"},ia=["for"],da=u(()=>e("i",{class:"bi bi-person cms-n2"},null,-1)),ca={key:0,class:"d-flex justify-content-center py-4"},ra=u(()=>e("div",{class:"spinner-border",role:"status"},null,-1)),_a=[ra],va={class:"col-12"},ma={class:"form-fields"},ha={class:"row gx-2 gx-md-3"},pa={class:"col-6 col-lg-3"},ga={class:"form-group"},fa=u(()=>e("label",{for:""},[b("Email Address"),e("span",{class:"text-danger"},"*")],-1)),ba={class:"tag-item"},ya={class:"tag-content"},ka=["onClick"],xa=u(()=>e("i",{class:"bi bi-x-lg"},null,-1)),Va=[xa],wa={class:"tag-input"},Da={class:"col-6 col-lg-3"},Aa={class:"form-group"},Ca=u(()=>e("label",{for:""},[b("Mobile Number"),e("span",{class:"text-danger"},"*")],-1)),Ia={class:"row gx-2"},Ra={class:"col-auto"},Na=["value"],Ma={class:"col"},Pa={class:"col-6 col-lg-3"},Ta={class:"form-group"},Sa=u(()=>e("label",{for:""},[b("First Name"),e("span",{class:"text-danger"},"*")],-1)),La={class:"col-6 col-lg-3"},Ua={class:"form-group"},Ya=u(()=>e("label",{for:""},[b("Last Name"),e("span",{class:"text-danger"},"*")],-1)),Fa={key:0,class:"col-12 text-end"},Ba={class:"row justify-content-end"},Ga={class:"col-auto"},Oa={class:"table fs-13 table-sm table-borderless w-auto booking-price-info"},Ea=u(()=>e("th",null,"Price Per Night:",-1)),qa={key:0},$a=u(()=>e("td",null,"Extra Guest:",-1)),Ha=u(()=>e("td",null,"Number of Nights:",-1)),Ka=u(()=>e("th",null,"Total:",-1)),za=u(()=>e("td",null,"Offer Price:",-1)),Ja={class:"input-group small-input-group"},Wa=u(()=>e("span",{class:"input-group-text"},"Rs",-1)),Qa={key:0},Xa={key:0},Za={key:1},ja=u(()=>e("td",null,"Taxable Amount:",-1)),es={class:"fs-6"},ts=u(()=>e("th",{class:"text-primary"},"Total Amount Payable:",-1)),as={class:"text-primary"},ss={class:"col-12"},ls={class:"form-group mb-0"},os=u(()=>e("label",{for:""},"Note",-1)),ns={class:"col-12"},us={type:"submit",class:"btn btn-save btn-primary"},is={key:0,class:"spinner-border spinner-border-sm",role:"status"},ds={key:1},cs={key:1,class:"message text-center"},rs=u(()=>e("h6",{class:"fw-bold"},"No Record Found!",-1)),_s=[rs],vs={__name:"by-location",emits:["onFrmSearch"],setup($,{emit:ms}){var ge,fe;const X=Ee("store");(ge=X.getters.user)==null||ge.role,(fe=X.getters.user)==null||fe.id;const C=qe(),De=$e(),de=s([]),v=s([]),T=s({}),S=s(""),M=s(""),Ae=F(),p=s(),g=s(),Z=s(Ae.format()),ce=s(),j=s(),G=s(!1),H=s(!1),K=s(!1),z=s(!1),I=s(),R=s(),O=s(),V=s(),J=s(),L=s(0),U=s(0),Ce=s("Exclusive"),re=s(0),Ie=s(null);s(null);const Re=s([]),ee=s(),N=s(0),Ne=s(),te=s(),Me=s(),ae=s(!1),se=s(!1),w=s({}),E=s(0),le=s(),_e=s({}),Pe=s({email_address:""}),D=s({emailAddresses:[]}),Te=(a,t)=>{a?D.value[t].splice(a,1):D.value[t].splice(0,1)},Se=(a,t,f,P)=>{let c=a.target.value.toLowerCase();!D.value[P].includes(c)&&c&&!t&&(D.value[P].push(a.target.value),a.target.value=null,Pe.value.resetField(f,!1))},ve=s("+91"),Le=s(["+1","+7","+20","+27","+30","+31","+32","+33","+34","+36","+39","+40","+41","+43","+44","+45","+46","+47","+48","+49","+51","+52","+53","+54","+55","+56","+57","+58","+60","+61","+62","+63","+64","+65","+66","+81","+82","+84","+86","+90","+91","+92","+93","+94","+95","+98","+211","+212","+213","+216","+218","+220","+221","+222","+223","+224","+225","+226","+227","+228","+229","+230","+231","+232","+233","+234","+235","+236","+237","+238","+239","+240","+241","+242","+243","+244","+245","+248","+249","+250","+251","+252","+253","+254","+255","+256","+257","+258","+260","+261","+262","+263","+264","+265","+266","+267","+268","+269","+290","+291","+297","+298","+299","+350","+351","+352","+353","+354","+355","+356","+357","+358","+359","+370","+371","+372","+373","+374","+375","+376","+377","+378","+379","+380","+381","+382","+383","+385","+386","+387","+389","+420","+421","+423","+500","+501","+502","+503","+504","+505","+506","+507","+508","+509","+590","+591","+592","+593","+594","+595","+596","+597","+598","+599","+670","+672","+673","+674","+675","+676","+677","+678","+679","+680","+681","+682","+683","+685","+686","+687","+688","+689","+690","+691","+692","+850","+852","+853","+855","+856","+880","+886","+960","+961","+962","+963","+964","+965","+966","+967","+968","+970","+971","+972","+973","+974","+975","+976","+977","+992","+993","+994","+995","+996","+998"]),Ue=async()=>{Q.get("/api/location/get/all",{params:{status:1,existing_property_id:C.params.id}}).then(a=>{a.data.status&&(de.value=a.data.data.data)}).catch(a=>{console.log(a)})};ne(p,(a,t)=>{a&&(Z.value=F(a).add(1,"day").format(),p.value>=g.value&&j.value.clearValue(),(p.value>=g.value||!g.value)&&j.value.openMenu())}),ne(g,(a,t)=>{a&&!p.value&&ce.value.openMenu()});const Ye=(a,t)=>{p.value&&g.value&&(t({values:{"location[]":S.value}}),v.value=[])},Fe=()=>{C.params.id&&Q.get(`/api/property/booking/detail/${C.params.id}`).then(a=>{a.data.status&&(v.value=a.data.data,E.value=a.data.tax_inclusive,w.value=v.value[0].customer_detail,S.value=v.value[0].location_id,p.value=v.value[0].checkin_date,g.value=v.value[0].checkout_date,U.value=v.value[0].no_of_adult,L.value=v.value[0].no_of_children,V.value=v.value[0].discount_amount,me(),M.value=v.value[0].property_id,ne(v,(t,f)=>{v.value.length&&M.value&&he("",M.value)}))}).catch(a=>{})},me=a=>{K.value=!0,H.value=!0,G.value=!0,M.value="",se.value=!1,Q.post("/api/property/list",{location_id:S.value,checkin_date:F(p.value).format("YYYY-MM-DD"),checkout_date:F(g.value).format("YYYY-MM-DD"),no_children:L.value,no_adults:U.value,tax_inclusive:E.value,existing_property_id:C.params.id}).then(t=>{t.data.status&&(_e.value=t.data.data,v.value=t.data.data.property_list,Re.value=t.data.data.gst_slab,I.value=t.data.data.no_of_nights,V.value=t.data.data.discount_amount,Ie.value=t.data.data.states,t.data.data.is_gst_allowed==1&&(Ce.value="Inclusive"),v.value.length?G.value=!1:G.value=!0,setTimeout(()=>{K.value=!1,H.value=!1},400))}).catch(t=>{K.value=!1,H.value=!1})},he=(a,t,f)=>{t&&(se.value=!0),ae.value=!0;let P=v.value.filter((c,i)=>{if(t==c.id)return R.value=c.gst_percentage,Ne.value=c.extra_guest_charges,ee.value=c.guests_included,te.value=U.value+L.value,te.value>ee.value?(Me.value=te.value-ee.value,N.value=c.final_extra_guest_charge,J.value=(c.per_night_price+N.value)*I.value,O.value=J.value):(J.value=c.per_night_price*I.value,O.value=J.value,N.value=0),c});T.value=P[0],re.value=0,C.params.id||(V.value=""),pe(),setTimeout(()=>{ae.value=!1},300)},W=ue(()=>q.value*R.value/100),q=ue(()=>V.value?(le.value=V.value*100/(100+R.value)/I.value,le.value*I.value):O.value*100/(100+R.value)),pe=()=>{let a=oe.value/I.value;R.value=a>8399?18:12,W.value=q.value*R.value/100},Be=({target:a})=>{pe()},oe=ue(()=>q.value+W.value),Ge=a=>{var t;z.value=!0,a.id=C.params.id,a.locationId=S.value,a.propertyId=M.value,a.checkInDate=F(p.value).format("YYYY-MM-DD"),a.checkOutDate=F(g.value).format("YYYY-MM-DD"),a.noOfNights=I.value,a.tax=R.value,a.taxAmount=W.value,a.netAmount=O.value,a.netPayableAmount=oe.value,a.discount_amount=V.value,a.additional_charges=T.value.additional_charge,a.type="Location",a.no_children=L.value,a.no_adult=U.value,a.per_night_price=T.value.per_night_price,a.initial_price=T.value.initial_price,a.tax_inclusive=E.value,a.is_invoice=re.value,a.totalTaxableAmount=q.value,a.extraGuestCharge=N.value,a.booking_created_by=(t=X.getters.user)==null?void 0:t.id,a.email_address=D.value.emailAddresses.length>0?D.value.emailAddresses:a.email_address,Q.post("/api/property/booking",a).then(f=>{f.data.status&&setTimeout(()=>{ke(f.data.message,"success").show(),z.value=!1,De.push({name:"booking-list"})},400)}).catch(f=>{ke(f.response.data.message,"error").show(),z.value=!1})};return He(()=>{Ue(),Fe()}),(a,t)=>{const f=ye("router-link"),P=ye("DatePicker");return o(),n("div",je,[e("div",et,[e("div",tt,[e("div",at,[e("h1",st,r(d(C).params.id?"Modify Booking":"New Booking"),1)]),e("div",lt,[_(f,{to:{name:"booking-list"},class:"btn rounded-pill btn-secondary-light"},{default:y(()=>[ot,b(" Manage ")]),_:1})])])]),e("ul",nt,[e("li",ut,[_(f,{to:{name:"by-location"},class:"active"},{default:y(()=>[b("By Location")]),_:1})]),d(C).params.id?k("",!0):(o(),n("li",it,[_(f,{to:{name:"by-property"}},{default:y(()=>[b("By Property")]),_:1})]))]),e("section",dt,[e("div",ct,[e("div",rt,[_(d(Ve),{onSubmit:me},{default:y(({errors:c,resetForm:i})=>[e("div",_t,[e("div",vt,[e("div",mt,[e("div",ht,[(o(!0),n(x,null,Y(de.value,(l,m)=>(o(),n("div",pt,[e("div",gt,[_(d(h),{type:"radio",name:"location[]",id:`lr${m}`,value:l.id,modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=be=>S.value=be),rules:"required",onChange:be=>Ye(l,i)},null,8,["id","value","modelValue","onChange"]),e("label",{for:`lr${m}`,class:A({"border-danger":c["location[]"]})},[e("h3",null,r(l.location_name),1)],10,ft)])]))),256))])])]),e("div",bt,[e("div",yt,[e("div",kt,[e("div",xt,[e("div",Vt,[wt,_(d(h),{name:"check-in-date",modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=l=>p.value=l),rules:"required"},{default:y(({field:l})=>[_(P,xe({ref_key:"checkInDateRef",ref:ce},l,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=m=>p.value=m),format:d(we),"enable-time-picker":!1,"min-date":new Date,"input-class-name":`form-control ${c["check-in-date"]?"border-danger":""}`,"prevent-min-max-navigation":"","auto-apply":""}),null,16,["modelValue","format","min-date","input-class-name"])]),_:2},1032,["modelValue"])])]),e("div",Dt,[e("div",At,[Ct,_(d(h),{name:"check-out-date",modelValue:g.value,"onUpdate:modelValue":t[4]||(t[4]=l=>g.value=l),rules:"required"},{default:y(({field:l})=>[_(P,xe({ref_key:"checkOutDateRef",ref:j},l,{modelValue:g.value,"onUpdate:modelValue":t[3]||(t[3]=m=>g.value=m),format:d(we),"enable-time-picker":!1,"min-date":Z.value,"start-date":Z.value,"input-class-name":`form-control ${c["check-out-date"]?"border-danger":""}`,"prevent-min-max-navigation":"","auto-apply":""}),null,16,["modelValue","format","min-date","start-date","input-class-name"])]),_:2},1032,["modelValue"])])]),e("div",It,[e("div",Rt,[e("div",Nt,[e("div",Mt,[Pt,_(d(h),{as:"select",name:"no_adults",modelValue:U.value,"onUpdate:modelValue":t[5]||(t[5]=l=>U.value=l),class:A(["form-control form-select",{"border-danger":c.no_adults}])},{default:y(()=>[Tt,St,(o(),n(x,null,Y(12,(l,m)=>e("option",{value:l},r(l),9,Lt)),64))]),_:2},1032,["modelValue","class"])])]),e("div",Ut,[e("div",Yt,[Ft,_(d(h),{as:"select",name:"no_children",modelValue:L.value,"onUpdate:modelValue":t[6]||(t[6]=l=>L.value=l),class:A(["form-control form-select",{"border-danger":c.no_children}])},{default:y(()=>[Bt,Gt,(o(),n(x,null,Y(12,(l,m)=>e("option",{value:l},r(l),9,Ot)),64))]),_:2},1032,["modelValue","class"])])]),e("div",Et,[e("div",qt,[$t,e("div",Ht,[e("div",Kt,[e("div",zt,[_(d(h),{type:"checkbox",name:"cbk-inclusive-tax",id:"cbk-inclusive-tax",class:"form-check-input",modelValue:E.value,"onUpdate:modelValue":t[7]||(t[7]=l=>E.value=l),value:1,"unchecked-value":0},null,8,["modelValue"])]),Jt])])])]),e("div",Wt,[e("button",Qt,[K.value?(o(),n("div",Xt)):(o(),n("span",Zt,"SEARCH"))])])])])])])])])]),_:1})]),G.value||v.value.length?(o(),n("div",jt,[H.value?(o(),n("div",ea,aa)):(o(),n(x,{key:1},[G.value?(o(),n("div",cs,_s)):(o(),Ke(d(Ve),{key:0,onSubmit:Ge},{default:y(({errors:c})=>[e("div",sa,[e("div",la,[e("div",oa,[e("div",na,[(o(!0),n(x,null,Y(v.value,(i,l)=>(o(),n("div",{key:l,class:"col-6 col-md-4 col-lg-3 col-xxl-auto"},[e("div",ua,[_(d(h),{type:"radio",name:"home[]",id:`hr${l}`,value:i.id,modelValue:M.value,"onUpdate:modelValue":t[8]||(t[8]=m=>M.value=m),onChange:m=>he(m,i.id,l),rules:"required"},null,8,["id","value","modelValue","onChange"]),e("label",{for:`hr${l}`,class:A({"border-danger":c["home[]"]})},[e("h3",null,r(i.home_name),1),e("p",null,[e("strong",null,"Rs. "+r(d(B)(i.price)),1),b(" Rs. "+r(d(B)(i.per_night_price))+"/night",1)]),e("p",null,[da,b(" "+r(i.maximum_number_of_guests)+" Max Occupancy",1)])],10,ia)])]))),128))])])]),se.value?(o(),n(x,{key:0},[ae.value?(o(),n("div",ca,_a)):(o(),n(x,{key:1},[e("div",va,[e("div",ma,[e("div",ha,[e("div",pa,[e("div",ga,[fa,e("div",{class:A(["tags-input-wrapper",{"border-danger":c.email_address}])},[e("ul",null,[D.value.emailAddresses.length?(o(!0),n(x,{key:0},Y(D.value.emailAddresses,(i,l)=>(o(),n("li",ba,[e("div",ya,[e("span",null,r(i),1),e("button",{type:"button",class:"tag-action",onClick:m=>Te(l,"emailAddresses")},Va,8,ka)])]))),256)):k("",!0),e("li",wa,[_(d(h),{type:"email",name:"email_address",class:"form-control",rules:D.value.emailAddresses.length?"email":"required|email",onKeypress:ze(Je(i=>Se(i,c.email_address,"email_address","emailAddresses"),["prevent"]),["enter"])},null,8,["rules","onKeypress"])])])],2)])]),e("div",Da,[e("div",Aa,[Ca,e("div",Ia,[e("div",Ra,[_(d(h),{as:"select",name:"c_code",class:A(["form-control form-select c-code pe-2",{"border-danger":c.c_code}]),modelValue:ve.value,"onUpdate:modelValue":t[9]||(t[9]=i=>ve.value=i)},{default:y(()=>[(o(!0),n(x,null,Y(Le.value,(i,l)=>(o(),n("option",{value:i},r(i),9,Na))),256))]),_:2},1032,["class","modelValue"])]),e("div",Ma,[_(d(h),{type:"text",name:"mobile_number",class:A(["form-control",{"border-danger":c.mobile_number}]),rules:"required|numeric|min:7|max:15",modelValue:w.value.mobile_number,"onUpdate:modelValue":t[10]||(t[10]=i=>w.value.mobile_number=i)},null,8,["class","modelValue"])])])])]),e("div",Pa,[e("div",Ta,[Sa,_(d(h),{type:"text",name:"first_name",class:A(["form-control",{"border-danger":c.first_name}]),rules:"required|alpha",modelValue:w.value.first_name,"onUpdate:modelValue":t[11]||(t[11]=i=>w.value.first_name=i)},null,8,["class","modelValue"])])]),e("div",La,[e("div",Ua,[Ya,_(d(h),{type:"text",name:"last_name",class:A(["form-control",{"border-danger":c.last_name}]),rules:"required|alpha",modelValue:w.value.last_name,"onUpdate:modelValue":t[12]||(t[12]=i=>w.value.last_name=i)},null,8,["class","modelValue"])])])]),Object.keys(T.value).length?(o(),n("div",Fa,[e("div",Ba,[e("div",Ga,[e("table",Oa,[e("tbody",null,[e("tr",null,[Ea,e("td",null,"Rs. "+r(d(B)(T.value.per_night_price)),1)]),N.value>0?(o(),n("tr",qa,[$a,e("td",null,"Rs. "+r(d(B)(N.value)),1)])):k("",!0),e("tr",null,[Ha,e("td",null,r(I.value),1)]),e("tr",null,[Ka,e("th",null,"Rs. "+r(d(ie)(O.value)),1)]),_e.value.tax_inclusive==1?(o(),n(x,{key:1},[e("tr",null,[za,e("td",null,[e("div",Ja,[Wa,We(e("input",{type:"number",name:"discount_amount",class:"form-control","onUpdate:modelValue":t[13]||(t[13]=i=>V.value=i),onInput:Be},null,544),[[Qe,V.value]])])])]),V.value?(o(),n("tr",Qa,[e("td",null,[b(" Price Per Night"),N.value==0?(o(),n("span",Xa,":")):k("",!0),N.value>0?(o(),n("span",Za," (Including Extra Guest):")):k("",!0)]),e("td",null,"Rs. "+r(d(B)(le.value)),1)])):k("",!0)],64)):k("",!0),e("tr",null,[ja,e("td",null,"Rs. "+r(d(ie)(q.value)),1)]),e("tr",null,[e("td",null,"GST ("+r(R.value)+"%):",1),e("td",null,"Rs. "+r(d(B)(W.value)),1)]),e("tr",es,[ts,e("th",as,"Rs. "+r(d(ie)(oe.value)),1)])])])])])])):k("",!0),e("div",ss,[e("div",ls,[os,_(d(h),{as:"textarea",name:"note",id:"",cols:"30",rows:"4",class:"form-control",modelValue:w.value.note,"onUpdate:modelValue":t[14]||(t[14]=i=>w.value.note=i)},null,8,["modelValue"])])])])]),e("div",ns,[e("button",us,[z.value?(o(),n("div",is)):(o(),n("span",ds,"SUBMIT"))])])],64))],64)):k("",!0)])]),_:1}))],64))])):k("",!0)])])])}}},fs=Oe(vs,[["__scopeId","data-v-8f7e69b1"]]);export{fs as default};
