import{u as K,z as J,r as a,o as O,B as Q,a as u,c,b as e,K as n,d as f,w as T,G as N,E as _,e as p,H as F,I as W,f as S,F as q,t as E}from"./app-Bv7sA21o.js";import{c as B}from"./common-iZsm-le3.js";import"./dayjs.min-CU4dOPv8.js";const X={class:"page-wrap property-add"},Y={class:"page-title mb-4"},Z={class:"row gy-3 align-items-center"},ee={class:"col align-self-end"},te={class:"h2 mb-0"},ae={class:"col-auto"},se=e("i",{class:"icon-list me-2"},null,-1),oe={class:"section"},le={key:0,class:"d-flex justify-content-center py-5"},ne=e("div",{class:"spinner-border",role:"status"},null,-1),ue=[ne],ce={class:"row"},de={class:"col-12 col-md-3"},ie={class:"text-primary m-0"},re={class:"col-12 col-md-6 text-md-center"},me=e("i",{class:"bi bi-calendar2-check"},null,-1),ve=e("i",{class:"bi bi-calendar2-check"},null,-1),_e={class:"col-12 col-md-3 text-md-end"},pe={class:"col-12 pt-3"},he={class:"bg-secondary text-white py-2 px-3 text-center rounded-5"},ye={key:0},be={class:"border pb-2 mt-4"},ge={class:"table-wrap"},fe={class:"table-responsive"},ke={class:"table align-middle mb-2"},qe=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Email"),e("th",null,"Amount"),e("th",null,"Payment Mode"),e("th",{class:"text-secondary fw-semibold"},"Action")])],-1),Ve={class:"input-group"},Re={class:"text-danger"},we={class:"text-danger"},Pe={class:"input-group flex-nowrap"},Ce=e("div",{class:"input-group-text"},"INR",-1),xe={class:"input-group"},Ne=e("option",{value:"",selected:"",disabled:""},"Choose Payment Mode",-1),Ee=["value"],Be={class:"text-danger"},Ae=["onClick"],Ie={key:1},De=["onClick"],Le={__name:"payment-request-edit",setup(Me){const A=K(),I=J(),i=a(!1),m=a([]),h=a([]),g=a([]),L=a([]);a();const D=a(0),$=a(["Razorpay","NEFT","Cash"]),y=a([]),V=a([]),R=a([]),d=a(0),b=a([]),w=a([]),k=a([]),P=a(!0),M=a(0),U=a(!1),z=a(!0),C=a([]),v=a([]),j=t=>{k.value[t]=!1,P.value=!0,U.value=!1},G=()=>{if(i.value=!0,I.params.id){let t=10;for(let s=1;s<=t;s++)L.value.push(s),V.value.push(""),R.value.push("");i.value=!0,S.get(`/api/property/booking/request/detail/${I.params.id}`).then(s=>{s.data.status&&(v.value=s.data.propertyBookingPaymentRequest,D.value=1,m.value=s.data.data,w.value.push(""),k.value.push(!1),d.value=s.data.availableAmount,M.value=s.data.data.payable_amount,h.value.push(v.value.email),g.value.push(v.value.amount),b.value.push(v.value.name),y.value.push(v.value.payment_mode),v.value=s.data.propertyBookingPaymentRequest,C.value.push(v.value.booking_request_id),d.value<=0&&A.push({name:"booking-list"}),setTimeout(()=>{i.value=!1},400))}).catch(s=>{i.value=!1})}},H=t=>{R.value[t]=h.value[t]==""?"Please Enter Email ID":"",V.value[t]=y.value[t]==""?"Please Choose Payment Mode":"",w.value[t]=b.value[t]==""?"Please Enter Name":"";let s=!1;if(g.value[t]<=d.value?s=!0:E("Amount can't be greater than Net Payable Amount","error").show(),b.value[t]!=""&&h.value[t]!=""&&y.value[t]!=""&&s&&d.value>0){i.value=!0;let x={email:h.value[t],amount:g.value[t],property_booking_id:m.value.id,payment_mode:y.value[t],name:b.value[t],booking_request_id:C.value[t]};S.post("/api/property/booking/payment/request",x).then(r=>{r.data.status&&setTimeout(()=>{E(r.data.message,"success").show(),C.value[t]=r.data.data.booking_request_id,i.value=!1,k.value[t]=!0,d.value=r.data.propertyBookingDetail.payable_amount-r.data.propertyBookingDetail.paid_amount,d.value<=0&&(P.value=!1),d.value<=0&&A.push({name:"booking-list"}),U.value=!0,z.value=!1},400)}).catch(r=>{E(r.response.data.message,"error").show(),i.value=!1})}};return O(()=>{G()}),(t,s)=>{const x=Q("router-link");return u(),c("div",X,[e("div",Y,[e("div",Z,[e("div",ee,[e("h1",te,"Booking Payment Request (ID: "+n(m.value.booking_id)+")",1)]),e("div",ae,[f(x,{to:{name:"booking-list"},class:"btn rounded-pill btn-secondary-light"},{default:T(()=>[se,_(" Manage ")]),_:1})])])]),e("section",oe,[i.value?(u(),c("div",le,ue)):(u(),c(N,{key:1},[e("div",ce,[e("div",de,[e("h3",ie,n(m.value.home_name),1)]),e("div",re,[me,_(" Check-in: "),e("b",null,n(m.value.checkin_date),1),_(" | "),ve,_(" Check-out: "),e("b",null,n(m.value.checkout_date),1)]),e("div",_e,[_(" Total Amount: "),e("b",null,"INR "+n(p(B)(m.value.payable_amount)),1)]),e("div",pe,[e("div",he,[_("Total/Remaining: "),e("b",null,"INR "+n(p(B)(M.value)),1),_(" / INR "+n(p(B)(d.value)),1)])])]),d.value>0?(u(),c("div",ye,[e("div",be,[e("div",ge,[e("div",fe,[e("table",ke,[qe,e("tbody",null,[(u(!0),c(N,null,F(D.value,(r,o)=>(u(),c("tr",{key:o},[e("td",null,[e("div",Ve,[f(p(q),{class:"form-control mw-150",type:"text",rules:"required",name:"customer_name[index]",modelValue:b.value[o],"onUpdate:modelValue":l=>b.value[o]=l,placeholder:"Enter Name"},null,8,["modelValue","onUpdate:modelValue"])]),e("span",Re,n(w.value[o]),1)]),e("td",null,[f(p(q),{class:"form-control mw-150",type:"text",rules:"required",name:"emails[index]",modelValue:h.value[o],"onUpdate:modelValue":l=>h.value[o]=l,placeholder:"Enter Email ID"},null,8,["modelValue","onUpdate:modelValue"]),e("span",we,n(R.value[o]),1)]),e("td",null,[e("div",Pe,[Ce,f(p(q),{class:"form-control mw-100",type:"text",rules:"required",name:"amounts[index]",modelValue:g.value[o],"onUpdate:modelValue":l=>g.value[o]=l},null,8,["modelValue","onUpdate:modelValue"])])]),e("td",null,[e("div",xe,[f(p(q),{class:"form-control mw-150",as:"select",rules:"required",name:"paymentModes[index]",modelValue:y.value[o],"onUpdate:modelValue":l=>y.value[o]=l},{default:T(()=>[Ne,(u(!0),c(N,null,F($.value,(l,Ue)=>(u(),c("option",{value:l},n(l),9,Ee))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),e("span",Be,n(V.value[o]),1)]),e("td",null,[!k.value[o]&&P.value?(u(),c("button",{key:0,class:"btn btn-save btn-primary",onClick:l=>H(o)},"Save",8,Ae)):(u(),c("div",Ie,[e("span",null,[e("i",{class:"bi bi-pencil-square",onClick:l=>j(o)},null,8,De)])]))])]))),128))])])])])])])):W("",!0)],64))])])}}};export{Le as default};
